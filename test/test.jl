using FractionalDiffEq
using Test


@testset "Test Diethelm algorithms" begin
    fun(x, y) = 1-y
    prob=FDEProblem(fun, 0.75, 0, 1, 0.01)
    result=solve(prob, ::PECE)
    tspan=collect(0:0.01:1)

    @test isapprox(result, [0.033578642299332176, 0.05610867472196339, 0.07502560358886001, 0.09200409235520345, 0.107599727268722, 0.12212518545994333, 0.13578052894999154, 0.14870453928676128, 0.16099902548397818, 0.17274180722536273, 0.18399427156575138, 0.1948060654083167, 0.20521816091171008, 0.21526494147714503, 0.22497566982126438, 0.23437555074680363, 0.24348651921083386, 0.2523278369187332, 0.2609165521830468, 0.26926786004824016, 0.2773953882993485, 0.28531142747148175, 0.2930271179165017, 0.3005526034967812, 0.30789715902829196, 0.31506929684743673, 0.3220768566085465, 0.3289270814867114, 0.3356266832660355, 0.34218189826984285, 0.34859853569014176, 0.3548820195664587, 0.36103742542522355, 0.3670695124036221, 0.3729827515338647, 0.37878135074578917, 0.38446927705123224, 0.39005027629710076, 0.39552789081205797, 0.4009054752208846, 0.4061862106588892, 0.41137311758415485, 0.41646906735681216, 0.4214767927305643, 0.4263988973815227, 0.43123786458266455, 0.4359960651177887, 0.4406757645167519, 0.4452791296834735, 0.44980823497917155, 0.45426506781597753, 0.4586515338092103, 0.4629694615312171, 0.46722060690464395, 0.47140665726876024, 0.47552923514877943, 0.4795899017549316, 0.4835901602350886, 0.48753145870230513, 0.491415193056536, 0.4952427096177383, 0.4990153075858235, 0.5027342413416127, 0.5064007226014211, 0.5100159224366775, 0.5135809731691157, 0.517096970150942, 0.520564973438564, 0.5239860093677755, 0.5273610720375426, 0.5306911247089211, 0.5339771011250918, 0.5372199067580291, 0.5404204199867874, 0.5435794932121117, 0.5466979539115155, 0.5497766056388185, 0.5528162289717717, 0.5558175824109721, 0.5587814032333644, 0.5617084083029356, 0.5645992948413963, 0.567454741161205, 0.570275407363369, 0.5730619360017793, 0.5758149527164522, 0.5785350668371575, 0.5812228719593013, 0.5838789464936598, 0.5865038541912343, 0.58909814464491, 0.5916623537688374, 0.5941970042571778, 0.5967026060227489, 0.5991796566172968, 0.6016286416337537, 0.604050035091881, 0.6064442998078728, 0.6088118877487905, 0.611153240372754, 0.613468788955327])
end